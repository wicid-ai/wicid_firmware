<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WICID Setup</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/favicon.svg" />

    <!-- Import shared design tokens -->
    <link rel="stylesheet" href="/design-tokens.css" />
    <script src="/main.js" defer></script>
    </head>
<body class="hero-background">
    <!-- Banner -->
    <div class="banner">
        <div class="banner-content">
            <div class="banner-logo">
                <div class="logo-circle"></div>
                <span>WICID</span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Setup Form State -->
        <div id="setupState" class="form-container animate-in">
            <div class="form-heading">
                <h1>WICID Simple Configuration</h1>
            </div>

            <div class="info">
                Welcome to your WICID setup. Connect to your WiFi network and set your location to start receiving weather updates.
            </div>

        <form id="setupForm">
            <!-- Error Display Area -->
            <div id="errorContainer" class="error-container hidden"></div>

            <div class="form-group">
                <label for="ssid">WiFi Network (SSID)</label>
                <div class="network-input-container">
                <select id="ssid" name="ssid" class="form-control network-select" required>
                    <option value="">Select a network...</option>
                    <!-- Available networks will be populated by JavaScript -->
                </select>
                <input type="text" id="ssid-manual" name="ssid" class="form-control" placeholder="Or enter network name manually">
                </div>
            </div>

            <div class="form-group">
                <label for="password">WiFi Password</label>
                <div class="password-container">
                    <input type="password" id="password" name="password" required
                           class="form-control password-input"
                           placeholder="Enter your WiFi password">
                <button type="button" class="password-toggle" id="passwordToggle" aria-label="Toggle password visibility">
                    <svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.74986 7.77881C6.46113 8.90053 4.91386 10.9371 4.29838 11.8582C4.10433 12.1486 4.10438 12.5181 4.29842 12.8085C5.1716 14.1153 7.91992 17.6667 12 17.6667C12.9219 17.6667 13.7758 17.4853 14.5554 17.1896" stroke="currentColor" stroke-linecap="round"/><path d="M10.5 10.1282C10.105 10.3975 9.78607 10.7701 9.58214 11.2071C9.4225 11.5492 9.33334 11.9309 9.33334 12.3333C9.33334 13.8061 10.5273 15 12 15C12.4204 15 12.8181 14.9027 13.1718 14.7294" stroke="currentColor"/><path d="M12 9.66663C13.4728 9.66663 14.6667 10.8605 14.6667 12.3333C14.6667 12.7802 14.5567 13.2015 14.3624 13.5715" stroke="currentColor" stroke-linecap="round"/><path d="M6 3L17 21" stroke="currentColor" stroke-linecap="round"/><path d="M11.5 7.01786C11.6644 7.00609 11.831 7 12 7C16.0801 7 18.8284 10.5514 19.7016 11.8582C19.8956 12.1486 19.8952 12.5188 19.7011 12.8092C19.2051 13.5514 18.1049 15.0165 16.5 16.1445" stroke="currentColor" stroke-linecap="round"/></svg>
                </button>
                </div>
            </div>

            <div class="form-group">
                <label for="zip_code">ZIP Code</label>
                <input type="text" id="zip_code" name="zip_code" required
                       pattern="\d{5}(-\d{4})?"
                       title="Please enter a valid US ZIP code"
                       class="form-control"
                       placeholder="e.g. 12345" value="">
            </div>


            <button type="submit" id="saveButton" class="btn-primary">
                <span class="button-text">Save & Connect</span>
                <span class="button-loader">
                    <svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </span>
            </button>
        </form>

        <div id="status" class="status hidden"></div>
        </div>

        <!-- Success State -->
        <div id="successState" class="form-container animate-in" style="display: none;">
            <div class="form-heading">
                <h1>Now Testing Connection...</h1>
            </div>

            <p>You will be disconnected from the <strong>WICID-Setup</strong> network while the configuration is saved and verified. Please be patient, as this could take up to 30 seconds.</p>
            
            <div class="info">
                <p><strong>Look at your WICID device for feedback:</strong></p>
                <p>• <strong>If successful,</strong> WICID will flash <span style="color: #2dc937;">green</span> 3 times, and your device will startup in normal mode. You're WICID awesome!</p>
                <p>• <strong>If it fails,</strong> WICID will flash <span style="color: #cc3232;">red</span> 3 times, followed by a pulsing white light. Please manually reconnect to the <strong>WICID-Setup</strong> WiFi network and <a href="http://192.168.4.1">click here</a> to try again.</p>
            </div>
        </div>

        <!-- System Details Footer -->
        <footer class="system-footer">
            <a href="#" id="systemDetailsToggle" class="system-details-link">
                System Details
                <svg class="chevron" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
            <div id="systemDetailsContent" class="system-details-content hidden">
                <div class="system-details-loading">Loading system information...</div>
            </div>
        </footer>
    </div>

    
    </body>
    </html>
